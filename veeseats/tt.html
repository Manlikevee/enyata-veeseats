<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Favicon Generator with Preview</title>
  <style>
    #favicon-preview {
      margin-top: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    #favicon-preview img {
      border: 1px solid #ccc;
      padding: 5px;
      margin-top: 10px;
    }
    input[type="text"] {
      padding: 8px;
      width: 100%;
      max-width: 400px;
    }
    button {
      margin-top: 10px;
      padding: 8px 16px;
    }
  </style>
</head>
<body>
  <div>
    <h2>Generate Favicon from Image URL</h2>
    <input type="text" id="image-url-input" placeholder="Enter image URL here" />
    <button onclick="generateFavicon()">Create Favicon</button>
  </div>
  
  <div id="favicon-preview">
    <h3>Favicon Preview:</h3>
    <img id="favicon-image" alt="Favicon Preview" style="display: none;" />
  </div>

  <canvas id="canvas" style="display: none;"></canvas>

  <script>
    function generateFavicon() {
      const imageUrl = document.getElementById('image-url-input').value;
      if (!imageUrl) {
        alert("Please enter a valid image URL!");
        return;
      }

      const canvas = document.getElementById('canvas');
      const ctx = canvas.getContext('2d');
      const img = new Image();
      img.crossOrigin = 'Anonymous'; // Important for cross-origin images

      img.onload = () => {
        // Set the canvas size to 32x32 (favicon size)
        canvas.width = 32;
        canvas.height = 32;

        // Draw the image to the canvas and scale it down
        ctx.drawImage(img, 0, 0, 32, 32);

        // Convert the canvas to a data URL
        const faviconUrl = canvas.toDataURL('image/png');

        // Update the favicon preview image
        const faviconImage = document.getElementById('favicon-image');
        faviconImage.src = faviconUrl;
        faviconImage.style.display = 'block';

        // Apply the favicon to the page
        const existingFavicon = document.querySelector("link[rel='icon']");
        if (existingFavicon) {
          existingFavicon.href = faviconUrl;
        } else {
          const link = document.createElement('link');
          link.rel = 'icon';
          link.href = faviconUrl;
          document.head.appendChild(link);
        }
      };

      img.onerror = () => {
        alert("Failed to load the image. Please check the URL and try again.");
      };

      img.src = imageUrl;
    }
  </script>
</body>
</html>
